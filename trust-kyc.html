// brhelpdesk-crypto-v3: Updated with Referral & Wallet System

const app = {
  users: [],
  referrals: {},

  register: function (name, referralCode, walletAddress) {
    if (!this.validateWallet(walletAddress)) {
      return "Invalid Trust Wallet Address";
    }

    const userCode = this.generateReferralCode(name);
    this.users.push({ name, referralCode, walletAddress, userCode });

    if (referralCode) {
      if (!this.referrals[referralCode]) this.referrals[referralCode] = [];
      this.referrals[referralCode].push(userCode);
    }

    return `Registered: ${name}, Your Referral Code: ${userCode}`;
  },

  validateWallet: function (address) {
    // Basic validation (start with '0x' and 42 chars total)
    return /^0x[a-fA-F0-9]{40}$/.test(address);
  },

  generateReferralCode: function (name) {
    return name.slice(0, 3).toUpperCase() + Math.floor(Math.random() * 9999);
  },

  showReferrals: function (code) {
    return this.referrals[code] || [];
  }
};

// Example usage
console.log(app.register("Ameer", "BRH1234", "0xAbc1234567890abcdefABCDEF1234567890abCDe"));
console.log(app.register("Nisa", "AME1234", "0x1234567890abcdefABCDEF1234567890abcdef12"));
console.log(app.showReferrals("AME1234"));
